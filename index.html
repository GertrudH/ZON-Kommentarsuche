<!DOCTYPE html>
<html>
    <head>
        <title>ZON Kommentarsuche</title>
        
        
        <meta charset="UTF-8">
        <meta name="author" content="Gertrud H.">
        <meta name="description" content="Benutzerkommentare auf ZON durchsuchen">
        
        <meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1, initial-scale=1">

        <style>
            
        </style>
        <script>

/* CONFIGURATION */

userURL = "http://community.zeit.de/user/{user}";

/* SOME GLOBALS */

var searchform, searchquery, searchuser, searchsubmit;
var username, useravatar, userlink;
var list, info;

var init = function () {
    searchform = getID("searchform");
    searchquery = getID("searchquery");
    searchuser = getID("searchuser");
    searchsubmit = getID("searchsubmit");
    list = getID("list");
    info = getID("info");
    
    searchsubmit.addEventListener("click", search);
}

var search = function (e) {
    var u = searchuser.value;
    var q = searchquery.value;
    
    u = u.toLowerCase();
    u = u.replace(/ /g, "-");
    u = u.replace(/[^0-9a-zA-Z\-]/g, "");
    u = u.replace(/\-+/, "-");
    
    var uurl = userURL.replace("{user}", u);
    
    console.log(uurl);
    
    ajax(uurl, "html", function (r) { console.log(r); });
}


document.addEventListener("DOMContentLoaded", init);

/* LITTLE HELPERS */

var getID = function (id) {
    return document.getElementById(id);
}

var element = function (type, attrs, parent) {
    var e = document.createElement(type);
    for (var i in attrs) if (attrs.hasOwnProperty(i)) e.setAttribute(i, attrs[i]);
    if (parent) parent.appendChild(e);
    return e;
}

var ajax = function (query, type, callback) {
    var request = new XMLHttpRequest();
    request.onreadystatechange = function () {
        if (request.readyState == 4 && request.status == 200) {
            if (request.responseText) {
                if (type == "js" || type == "json")
                    callback(eval('(' + request.responseText + ')'));
                else
                    callback(request.responseText);
            } else
                callback();
        }
    }
    request.open("GET", query, true);
    request.send();
}
            
        </script>
    </head>
    <body>
        <div id="searchform">
            <input type="text" id="searchuser" placeholder="Benutzer"></input>
            <label for="searchuser">Benutzername, Benutzer-ID, Benutzer-URL</label>
            <input type="text" id="searchquery" placeholder="Suchbegriff"></input>
            <label for="searchuser">Suchbegriff (Leer f√ºr alle Kommentare)</label>
            <button id="searchsubmit">Suchen</button>
        </div>
        <div id="info"></div>
        <ul id="list"></ul>
        <div id="help">
